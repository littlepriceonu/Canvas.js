<style>
    canvas {
        position: absolute;
        top: 0;
        left: 0;
    }
</style>

<body>
    <canvas id="canvas"></canvas>
</body>

<script>
    var c = document.getElementById('canvas');
    c.width = innerWidth
    c.height = innerHeight

    class CanvasManager {
        constructor (Canvas, updatecallback, clearonupdate) {
            this.canvas = Canvas
            this.ctx = Canvas.getContext("2d");
            this.updatecallback = updatecallback;
            this.callbacklength = updatecallback.length
            this.clearonupdate = clearonupdate;
        }

        update () {
            if (this.clearonupdate) {
                this.ctx.clearRect(0, 0, window.innerWidth, innerHeight)
            }
            for (let i = 0; i < this.callbacklength; i++) {
                updatecallback[i](this.canvas)
            }
        }

        startUpdate() {
            setInterval(this.update, 10);
        }

        addcallback (func) {
            this.updatecallback.push(func)
        }
    }

    class circle {
        constructor (x, y, radius, startpoint, endpoint) {
            this.x = x;
            this.y = y;
            this.radius = radius;
            this.startpoint = startpoint;
            this.endpoint = endpoint;
        }

        draw(ctx) {
            ctx.beginPath();
            ctx.arc(this.x, this.y, this.radius, this.startpoint, this.endpoint);
            ctx.stroke();
        }
    }

    var ball = new circle(500, 350, 50, 0, 2*Math.PI)

    var isdown = false;
    var x, y = 0;


    addEventListener("mousedown", () => {
        isdown = true;
    })

    addEventListener("mousemove", event => {
        if (isdown) {
            x = event.x
            y = event.y
            ball.x = x;
            ball.y = y;
            console.log(x, y)
        }
    })
    
    addEventListener("mouseup", event => {
        isdown = false;
    })

    var xgoback = false;
    var ygoback = false;

    function animate(canvas) {
        if (!xgoback && !isdown) {
            ball.x += 3;
        }
        else if (!isdown) {
            ball.x -= 3;
        }

        if (!ygoback && !isdown) {
            ball.y += 3;
        }
        else if (!isdown) {
            ball.y -= 3;
        }


        if (ball.y+ball.radius >= innerHeight) {
            ygoback = true;
        }

        if (ball.y-ball.radius <= 0) {
            ygoback = false;
        }

        if (ball.x+ball.radius >= innerWidth) {
            xgoback = true;
        }

        if (ball.x-ball.radius <= 0) {
            xgoback = false;
        }
        console.log(canvas)
        ball.draw(canvas.getContext('2d'))
    }

    addEventListener("resize", () => {
        canvas.height = innerHeight;
        canvas.width = innerWidth;
    })
    var canvasmanager = new CanvasManager(c, [animate], true)
    canvasmanager.startUpdate()
    
</script>